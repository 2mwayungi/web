if (self.CavalryLogger) { CavalryLogger.start_js(["YtsSh"]); }

__d("FBRTCCallControlActions",["FBRTCDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({ACCEPT_ESCALATION:null,HANG_UP:null,PARENT_WINDOW_START_CALL:null,TOGGLE_FULL_SCREEN:null,TOGGLE_MUTE_AUDIO:null,TOGGLE_MUTE_VIDEO:null,TOGGLE_SCREEN_SHARING:null,TOGGLE_SELF_VIEW:null,SHOW_SETTINGS:null,START_CALL:null,DECLINE_ESCALATION:null,RECEIVED_SIGNALING_MESSAGE:null,RESET_CALL:null,OPEN_SCREEN_IN_NEW:null,CLOSE_STANDALONE_SCREEN:null,REDIAL_CALL:null});a={Types:g,hangUp:function(){b("FBRTCDispatcher").dispatch({type:g.HANG_UP})},toggleMuteAudio:function(){b("FBRTCDispatcher").dispatch({type:g.TOGGLE_MUTE_AUDIO})},toggleMuteVideo:function(){b("FBRTCDispatcher").dispatch({type:g.TOGGLE_MUTE_VIDEO})},toggleFullScreen:function(){b("FBRTCDispatcher").dispatch({type:g.TOGGLE_FULL_SCREEN})},toggleSelfView:function(){b("FBRTCDispatcher").dispatch({type:g.TOGGLE_SELF_VIEW})},showSettings:function(){b("FBRTCDispatcher").dispatch({type:g.SHOW_SETTINGS})},toggleScreenSharing:function(){b("FBRTCDispatcher").dispatch({type:g.TOGGLE_SCREEN_SHARING})},startCall:function(){b("FBRTCDispatcher").dispatch({type:g.START_CALL})},openScreenInNewWindow:function(){b("FBRTCDispatcher").dispatch({type:g.OPEN_SCREEN_IN_NEW})},receivedSignalingMessage:function(a){b("FBRTCDispatcher").dispatch({type:g.RECEIVED_SIGNALING_MESSAGE,message_type:a.msgType,message:a})},acceptEscalation:function(){b("FBRTCDispatcher").dispatch({type:g.ACCEPT_ESCALATION})},declineEscalation:function(){b("FBRTCDispatcher").dispatch({type:g.DECLINE_ESCALATION})},resetCall:function(a){b("FBRTCDispatcher").dispatch({type:g.RESET_CALL,trigger:a})},redialCall:function(){b("FBRTCDispatcher").dispatch({type:g.REDIAL_CALL})},parentWindowStartCall:function(){b("FBRTCDispatcher").dispatch({type:g.PARENT_WINDOW_START_CALL})}};e.exports=a}),null);
__d("FBRTCStruct",[],(function(a,b,c,d,e,f){__p&&__p();var g=function(a,b,c){var d=void 0,e=void 0;if(typeof a=="string"||a instanceof String)e=a,d=a;else for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(f==="index"?c=a[f]:(e=f,d=a[f]));b[e]=c;b.strNames[c]=d};function a(a){"use strict";this.strNames=[];for(var b=0;b<a.length;b++)g(a[b],this,b)}e.exports=a}),null);
__d("FBRTCConstants",["FBRTCStruct","keyMirror"],(function(a,b,c,d,e,f){__p&&__p();a=Object.freeze({OFFER:"offer",ANSWER:"answer",ICE_CANDIDATE:"ice_candidate",OK:"ok",PING:"ping",PING_ACK:"ping_ack",HANGUP:"hang_up",OTHER_DISMISS:"other_dismiss",MSG_ACK:"msg_ack",PRANSWER:"pranswer",ICERESTART_OFFER:"icerestart_offer",ICERESTART_ANSWER:"icerestart_answer",PCRESTART_OFFER:"pcrestart_offer",PCRESTART_ANSWER:"pcrestart_answer",SDP_UPDATE:"sdp_update",OFFER_ACK:"offer_ack",OFFER_NACK:"offer_nack",ANSWER_ACK:"answer_ack",SET_VIDEO:"set_video",VIDEO_REQUEST:"video_request",ACK:"ack",SWITCH_TO_MULTIWAY:"switch_to_multiway"});c=Object.freeze({CHILD_WINDOW_READY:"rtc_child_window_ready",CHILD_WINDOW_START_CALL:"rtc_child_window_start_call",CHILD_WINDOW_MESSAGE:"rtc_child_window_message"});d=Object.freeze({DIRECT_VIDEO:"direct_video",ESCALATED:"escalated",ESCALATION_DECLINED:"escalation_declined",VOIP:"voip"});var g=Object.freeze({LL_NONE:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5});f=Object.freeze({AUDIO_ONLY:"audio_only",AUDIO_VIDEO:"audio_video",SCREEN_CONTENT:"screen"});var h=Object.freeze({CUSTOM_VIDEO_STREAM_SIZE:"CUSTOM_VIDEO_STREAM_SIZE",CUSTOM_VIDEO:"CUSTOM_VIDEO",FHD_VIDEO:"FHD_VIDEO",HD_VIDEO:"HD_VIDEO",LQ_VIDEO:"LQ_VIDEO",NO_VIDEO:"NO_VIDEO",SD_VIDEO:"SD_VIDEO"}),i=Object.freeze({CONFETTI_EFFECT:"ConfettiEffect",COPY_CATS_EFFECT:"CopyCatsEffect",PORCH_LIGHTS_EFFECT:"PorchLightsEffect",SNOWFALL_EFFECT:"SnowfallEffect",STAR_BOKEH_EFFECT:"StarBokehEffect"}),j=Object.freeze({FHD_HEIGHT:1080,HD_HEIGHT:720,LQ_HEIGHT:180,SD_HEIGHT:480,FHD_WIDTH:1920,HD_WIDTH:1280,LQ_WIDTH:320,SD_WIDTH:848,VLQ_FRAME_RATE:5,LQ_FRAME_RATE:15,FRAME_RATE:30}),k=new(b("FBRTCStruct"))([{IGNORE_CALL:"IgnoreCall"},{HANGUP_CALL:"HangupCall"},{IN_ANOTHER_CALL:"InAnotherCall"},{ACCEPT_AFTER_HANGUP:"CallEndAcceptAfterHangUp"},{NO_ANSWER_TIMEOUT:"NoAnswerTimeout"},{INCOMING_TIMEOUT:"IncomingTimeout"},{OTHER_INSTANCE_HANDLED:"OtherInstanceHandled"},{SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed"},{CONNECTION_DROPPED:"ConnectionDropped"},{CLIENT_INTERRUPTED:"ClientInterrupted"},{WEBRTC_ERROR:"WebRTCError"},{CLIENT_ERROR:"ClientError"},{NO_PERMISSION:"NoPermission"},{OTHER_NOT_CAPABLE:"OtherNotCapable"},{NO_UI_ERROR:"NoUIShown"},{UNSUPPORTED_VERSION:"VersionUnsupported"},{CALLER_NOT_VISIBLE:"CallerNotVisible"},{CARRIER_BLOCKED:"CarrierBlocked"},{OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked"},{CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError"},{INACTIVE_TIMEOUT:"InactiveTimeout"}]),l=Object.freeze({CALL_INITIALIZATION_FAILED:"CollabCallInitializationFailed",CLOSED_AS_STALE:"CollabClosedAsStale",CLOSED_BY_MCU:"CollabClosedByMcu",LOST_MCU_CONNECTION:"CollabLostMcuConnection",LOST_MCU_THRIFT_CONNECTION:"CollabLostMcuThriftConnection",LOST_SIP_ADAPTER_CONNECTION:"CollabLostSipAdapterConnection",MCU_INVALID_STREAM_CONFIGURATION:"CollabMcuInvalidStreamConfiguration",MCU_NO_AUDIO_STREAM:"CollabMcuNoAudioStream",REMOTE_PEER_HANGUP:"CollabRemotePeerHangup",REMOTE_PEER_REJECT:"CollabRemotePeerReject",SIP_CONNECTION_INITIALIZATION_FAILED:"CollabSipConnectionInitializationFailed",UNKNOWN:"CollabUnknown"}),m=Object.freeze({TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10}),n=Object.freeze({ONE_HOUR:"1hour",UNTIL_EIGHT_AM:"8am",ALWAYS:"always"});b=b("keyMirror")({AUDIO:null,VIDEO:null});var o=Object.freeze({CUSTOM:"custom",MULTIWAY:"multiway",P2P:"p2p"}),p=Object.freeze({NEW:"new",CHECKING:"checking",CONNECTED:"connected",COMPLETED:"completed",FAILED:"failed",DISCONNECTED:"disconnected",CLOSED:"closed"}),q=Object.freeze({DOMINANT_SPEAKER:"DOMINANT_SPEAKER",GRID:"GRID"});n={CallBlockingConstants:n,CallEndReason:k,CallType:d,ChildWindowMessageType:c,CollabCallEndSubreason:l,GroupVideoViewLayout:q,IceConnectionState:p,IncomingCallDialogTypes:b,PayloadType:a,RTCConstraints:j,SignalingProtocol:o,StreamType:f,UIEventType:m,UploadLogLevel:g,VideoFilterEffect:i,VideoQuality:h,convertFromUploadLogLevel:function(a){switch(a){case g.LL_DEBUG:return"d";case g.LL_BASIC:return"b";case g.LL_WARNING:return"w";case g.LL_INFO:return"i";case g.LL_VERBOSE:return"v";case g.LL_NONE:default:return null}},convertToUploadLogLevel:function(a){switch(a){case"d":return g.LL_DEBUG;case"b":return g.LL_BASIC;case"w":return g.LL_WARNING;case"i":return g.LL_INFO;case"v":return g.LL_VERBOSE;default:return g.LL_NONE}},uploadLogLevelString:function(a){switch(a){case g.LL_BASIC:return"basic";case g.LL_DEBUG:return"debug";case g.LL_WARNING:return"warning";case g.LL_INFO:return"info";case g.LL_VERBOSE:return"verbose";default:return""}},endCallReasonFromString:function(a){return k.strNames.indexOf(a)},callEndReasonString:function(a){return a<0||a>k.strNames.length?"Unknown":k.strNames[a]},fullCallEndReasonString:function(a,b){return this.callEndReasonString(a)+"_"+(b?"remote":"local")}};e.exports=n}),null);
__d("RTCCallActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CALL:"CALL",CALL_SUCCESS:"CALL_SUCCESS",CALL_ERROR:"CALL_ERROR",INCOMING_CALL_SUCCESS:"INCOMING_CALL_SUCCESS",INIT:"INIT",RESET:"RESET",WAIT_FOR_USER_INPUT:"WAIT_FOR_USER_INPUT",SET_CALL_SUMMARY:"SET_CALL_SUMMARY",SET_MW_CALL_TYPE:"SET_MW_CALL_TYPE",SET_LAYOUT:"SET_LAYOUT",SET_DOMINANT_SPEAKER:"SET_DOMINANT_SPEAKER",SET_PINNED_SPEAKER:"SET_PINNED_SPEAKER",SET_USE_DOMINANT_SPEAKE_VIEW:"SET_USE_DOMINANT_SPEAKE_VIEW",SET_GRID_VIEW:"SET_GRID_VIEW",SET_STRIP_VIEW:"SET_STRIP_VIEW",INIT_THREAD:"INIT_THREAD",ON_PARTICIPANT_LEFT:"ON_PARTICIPANT_LEFT",ON_PARTICIPANTS_ADDED:"ON_PARTICIPANTS_ADDED",ADD_PARTICIPANTS_TO_RING:"ADD_PARTICIPANTS_TO_RING",JOIN:"JOIN",JOIN_SUCCESS:"JOIN_SUCCESS",JOIN_ERROR:"JOIN_ERROR",HANGUP:"HANGUP",HANGUP_SUCCESS:"HANGUP_SUCCESS",HANGUP_ERROR:"HANGUP_ERROR",ON_CONFERENCE_STATE:"ON_CONFERENCE_STATE",DISMISS:"DISMISS",END_CALL:"END_CALL",ON_JOIN_REQUEST_SENT:"ON_JOIN_REQUEST_SENT",ON_JOIN_RESPONSE:"ON_JOIN_RESPONSE",ON_RECEIVED_JOIN_RESPONSE:"ON_RECEIVED_JOIN_RESPONSE",ON_PROCESSED_JOIN_RESPONSE:"ON_PROCESSED_JOIN_RESPONSE",ON_SERVER_MEDIA_UPDATE_SUCCESS:"ON_SERVER_MEDIA_UPDATE_SUCCESS",ON_CLIENT_MEDIA_UPDATE_RESPONSE:"ON_CLIENT_MEDIA_UPDATE_RESPONSE",INIT_LOCAL_USER:"INIT_LOCAL_USER",INIT_REMOTE_USERS:"INIT_REMOTE_USERS",ADD_REMOTE_STREAM:"ADD_REMOTE_STREAM",REMOVE_REMOTE_STREAM:"REMOVE_REMOTE_STREAM",REMOVE_ALL_REMOTE_STREAMS:"REMOVE_ALL_REMOTE_STREAMS",SET_PREFERRED_REMOTE_STREAM:"SET_PREFERRED_REMOTE_STREAM",ADD_REMOTE_TRACK:"ADD_REMOTE_TRACK",REMOVE_REMOTE_TRACK:"REMOVE_REMOTE_TRACK",AUDIO_MUTED:"AUDIO_MUTED",AUDIO_UNMUTED:"AUDIO_UNMUTED",VIDEO_MUTED:"VIDEO_MUTED",VIDEO_UNMUTED:"VIDEO_UNMUTED",REMOTE_VIDEO_MUTED:"REMOTE_VIDEO_MUTED",REMOTE_VIDEO_UNMUTED:"REMOTE_VIDEO_UNMUTED",SELF_VIEW_COLLAPSED:"SELF_VIEW_COLLAPSED",SELF_VIEW_UNCOLLAPSED:"SELF_VIEW_UNCOLLAPSED",ADD_LOCAL_STREAM:"ADD_LOCAL_STREAM",REMOVE_LOCAL_STREAM:"REMOVE_LOCAL_STREAM",REPLACE_LOCAL_STREAM:"REPLACE_LOCAL_STREAM",REMOVE_ALL_LOCAL_STREAMS:"REMOVE_ALL_LOCAL_STREAMS",SET_PREFERRED_LOCAL_STREAM:"SET_PREFERRED_LOCAL_STREAM",ADD_LOCAL_SCREEN_STREAM:"ADD_LOCAL_SCREEN_STREAM",REMOVE_LOCAL_SCREEN_STREAM:"REMOVE_LOCAL_SCREEN_STREAM",REMOVE_ALL_LOCAL_SCREEN_STREAMS:"REMOVE_ALL_LOCAL_SCREEN_STREAMS",REPLACE_LOCAL_SCREEN_STREAM:"REPLACE_LOCAL_SCREEN_STREAM",ADD_REMOTE_SCREEN_STREAM:"ADD_REMOTE_SCREEN_STREAM",REMOVE_REMOTE_SCREEN_STREAM:"REMOVE_REMOTE_SCREEN_STREAM",TOGGLE_REMOTE_STREAM:"TOGGLE_REMOTE_STREAM",SUBMIT_RATING:"SUBMIT_RATING",SUBMIT_FEEDBACK:"SUBMIT_FEEDBACK",RATING_SHOWN:"RATING_SHOWN",FEEDBACK_SHOWN:"FEEDBACK_SHOWN",SET_CONFERENCE_STATE:"SET_CONFERENCE_STATE",SET_END_CALL_REASON:"SET_END_CALL_REASON",FLOOR_STATUS:"FLOOR_STATUS"})}),null);
__d("RTCP2PCallActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({P2P_DISMISS_NUX:"P2P_DISMISS_NUX",P2P_INIT_NUX_STATE:"P2P_INIT_NUX_STATE",P2P_MARK_NUX_VIEWED:"P2P_MARK_NUX_VIEWED",P2P_PROCESS_MESSAGE:"P2P_PROCESS_MESSAGE",P2P_SET_IS_CALLER:"P2P_SET_IS_CALLER",P2P_STAR_RATING_DONE:"P2P_STAR_RATING_DONE",POP_IN_SCREEN_CONTENT:"POP_IN_SCREEN_CONTENT",POP_OUT_SCREEN_CONTENT:"POP_OUT_SCREEN_CONTENT",SET_CALL_TYPE:"SET_CALL_TYPE",SET_CONNECTION_STATUS:"SET_CONNECTION_STATUS",SET_MULTIWAY_ESCALATION_SUPPORT:"SET_MULTIWAY_ESCALATION_SUPPORT",SET_REMOTE_SIGNALING_EXPERIMENTS:"SET_REMOTE_SIGNALING_EXPERIMENTS",SET_VIDEO_QUALITY:"SET_VIDEO_QUALITY",TOGGLE_CHAT_WINDOW:"TOGGLE_CHAT_WINDOW"})}),null);
__d("RTCP2PCallEscalationActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({P2P_CALL_ESCALATION_ACK:"P2P_CALL_ESCALATION_ACK",P2P_CALL_ESCALATION_FAILURE:"P2P_CALL_ESCALATION_FAILURE",P2P_CALL_ESCALATION_SET_REQUEST:"P2P_CALL_ESCALATION_SET_REQUEST",P2P_CALL_ESCALATION_SET_RESPONSE:"P2P_CALL_ESCALATION_SET_RESPONSE",P2P_CALL_ESCALATION_START:"P2P_CALL_ESCALATION_START",P2P_CALL_ESCALATION_SUCCESS:"P2P_CALL_ESCALATION_SUCCESS"})}),null);
__d("FBRTCExperiment",["FBRTCExperimentsConfig","QE2Logger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();g.gen=function(a){var c={params:{},auto_exposure:!1,in_experiment:!1};c=b("FBRTCExperimentsConfig")[a]||c;a=new g(a,c);return a};g.getIncomingCallExperiments=function(){return g.gen("rtweb_incoming_call_experiments")};function g(a,b){this.$1=a,this.$2=b}g.prototype.$3=function(){this.$2.auto_exposure&&this.logExposure()};g.prototype.logExposure=function(){this.$2.in_experiment&&b("QE2Logger").logExposureForUser(this.$1)};g.prototype.getParam=function(a,b){if(this.$2.in_experiment){this.$3();if(this.$2.params[a]!==undefined)return this.$2.params[a].toString()}return b};g.prototype.getInt=function(a,b){if(this.$2.in_experiment){this.$3();if(this.$2.params[a]!==undefined)return parseInt(this.$2.params[a],10)}return b};g.prototype.getBool=function(a,b){var c=this.$2.params;if(this.$2.in_experiment){this.$3();if(c[a]!==undefined)return c[a]==="1"||c[a]===1||c[a]==="true"||c[a]===!0}return b};e.exports=g}),null);
__d("FBRTCSdpUtils",["FBLogger","UserAgent"],(function(a,b,c,d,e,f){__p&&__p();var g="a=x-fb-feature:",h="\r\n",i="m=video 0";d=["audio","video"].map(function(a){return new RegExp("m="+a+"\\s+\\d+\\s+(\\w+\\/?)+(\\s+\\d+)+")});var j=d[0],k=d[1],l=["http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01","http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time","http://www.webrtc.org/experiments/rtp-hdrext/playout-delay","urn:3gpp:video-orientation","urn:ietf:params:rtp-hdrext:ssrc-audio-level","urn:ietf:params:rtp-hdrext:toffset"],m=function(a){return a.match(/^a=rtpmap:(\d+)\s/)[1]},n=function(a,b,c){var d=m(a[b]),e=a[c].split("RTP/SAVPF"),f=e[1].split(/\s+/);d=f.indexOf(d);f.splice(d,1);e[1]=f.join(" ");a[c]=e.join("RTP/SAVPF");a.splice(b,1)},o=function(a,b,c){__p&&__p();var d=m(a[b]);n(a,b,c);var e=new RegExp("^a=(rtcp-fb|fmtp):"+d+" ");a=a.filter(function(a){return!e.test(a)});var f=new RegExp("^a=fmtp:(\\d+)\\s+apt="+d+"($|;)");b=a.reduce(function(a,b,c){c=b.match(f);return c?[].concat(a,[c[1]]):a},[]).join("|");var g=new RegExp("^a=rtpmap:("+b+")\\s+rtx/|^a=fmtp:("+b+")\\s+apt=");return a.filter(function(a){return!g.test(a)})},p={RX_SDP_MEDIA_AUDIO:j,RX_SDP_MEDIA_VIDEO:k,replaceRTPSAVPFProfile:function(a){var b="UDP/TLS/RTP/SAVPF",c="RTP/SAVPF";while(a.indexOf(b)>=0)a=a.replace(b,c);return a},addIceOptionToSdp:function(a,b){"use strict";__p&&__p();var c="a=ice-options:",d=a.indexOf(c);if(d>=0)return a.split(h).map(function(a){return a.startsWith(c)?a+" "+b:a}).join(h);d=c+b;var e=a.split(h),f=!1,g=-1;for(var i=0;i<e.length;i++){var j=e[i].slice(0,2);if(j=="s="){f=!0;continue}if(f&&j=="a="){g=i;break}}if(g>=0){e.splice(g,0,d);return e.join(h)}return[a,d,h].join("")},preferIsac:function(a){__p&&__p();a=a.split(h);var b=-1,c=-1,d=-1;for(var e=0;e<a.length;e++){var f=a[e];f.match(j)&&(b=e);d===-1&&b>-1&&f.match(/^a=rtpmap:/)&&(d=e);f.match(/^a=rtpmap:\d+\s+ISAC\/16000/)&&(c=e)}if(b===-1||c===-1||d===-1||a[b].indexOf("RTP/SAVPF")===-1)return a.join(h);f=a[c];n(a,c,b);a.splice(d,0,f);a[b]=a[b].replace("RTP/SAVPF","RTP/SAVPF "+m(f));return a.join(h)},preferCodec:function(a,b,c){__p&&__p();var d=a.split(h),e=c?k:j,f=d.findIndex(function(a){return e.test(a)});f!==-1&&d[f].indexOf("RTP/SAVPF")!==-1&&(function(){var a=new RegExp("^a=rtpmap:\\d+\\s+"+b),c=d.findIndex(function(b){return a.test(b)}),e=/^a=rtpmap:/,g=d.findIndex(function(a,b){return b>f&&e.test(a)});if(c!==-1&&g!==-1){var h=d[c];n(d,c,f);d.splice(g,0,h);d[f]=d[f].replace("RTP/SAVPF","RTP/SAVPF "+m(h))}})();return d.join(h)},disableVideo:function(a){var c=/m=video\s+\S+/;a=a.replace(c,i);b("UserAgent").isBrowser("Firefox <= 37")&&(a=this._makeDisabledVideoReceiveOnly(a));return a},_makeDisabledVideoReceiveOnly:function(a){if(a.indexOf(i)>-1){var b=a.split(i);b[1]=b[1].replace(/send(recv|only)/,"recvonly");a=b.join(i)}return a},fixMobileIceSdp:function(a){__p&&__p();a=a.replace(/^a=/,"");a=a.split(/\s+username\s+.+password.+/)[0];var b=a.match(/\s+relay\s+|\s+srflx\s+/),c=a.match(/raddr.+rport.+/);if(b&&!c){b=b[0];c=a.split(b);var d=c[1].match(/^(\d+\.\d+\.\d+\.\d+)\s+(\d+)\s+/),e=void 0,f=void 0;d?(e=d[1],f=d[2],c[1]=c[1].replace(d[0],"")):(d=c[0].split(/\s+/),e=d[4],f=d[5]);a=""+c[0]+b+"raddr "+e+" rport "+f+" "+c[1]}return a},addAudioNack:function(a){var b=[];a=a.split(h).map(function(a){var c="";b.length>0&&(/^a=rtpmap:(\d+)/.test(a)||/^a=ssrc/.test(a)||/^m=/.test(a))&&(c+=this._getrtcpFeedbackLinesFromAudioFMTs(b)+h,b=[]);/^m=audio/.test(a)&&(b=a.match(/^m=audio\s+[\d\/]+\s+[\w\/]+([\s+\d+]+)/)[1].trim().split(" "));return c+a}.bind(this)).join(h);b.length>0&&(a+=h+this._getrtcpFeedbackLinesFromAudioFMTs(b));return a},addSetup:function(a){if(a.indexOf("a=setup:")>=0)return a;a=a.split(h);var b=a.findIndex(function(a){return a.startsWith("s=")}),c=a.findIndex(function(a,c){return c>b&&a.startsWith("a=")});a.splice(c,0,"a=setup:actpass");return a.join(h)},_replaceFmtp:function(a,b,c,d){a=a==b?[]:a.substr(b.length).split(";");var e=a.findIndex(function(a){return a.startsWith(c+"=")});d=c+"="+d;e<0?a.push(d):a[e]=d;return""+b+a.join(";")},_addFmtpToMediaSection:function(a,b,c,d){__p&&__p();var e=new RegExp("^a=rtpmap:(\\d+)\\s"+b);b=a.findIndex(function(a){return a.match(e)});if(b<0)return a;var f=a[b].match(e);f=f[1];var g="a=fmtp:"+f+" ";f=a.findIndex(function(a){return a.startsWith(g)});f===-1&&(f=b+1,a.splice(f,0,g));a[f]=this._replaceFmtp(a[f],g,c,d);return a},addFmtp:function(a,b,c,d){__p&&__p();a=a.split(h);var e=-1;for(var f=0;f<=a.length;f++)if(f===a.length||a[f].startsWith("m=")){if(e!==-1){var g=a.splice(e,f-e);g=this._addFmtpToMediaSection(g,b,c,d);a.splice.apply(a,[e,0].concat(g));f=e+1+g.length}e=f}return a.join(h)},_getrtcpFeedbackLinesFromAudioFMTs:function(a){return a.map(function(a){return"a=rtcp-fb:"+a+" nack"}).join(h)},removeFEC:function(a){a=a.split(h);var b=void 0,c=void 0;for(var d=0;d<a.length;d++)a[d].match(/^a=rtpmap:\d+\s+red\//)&&(b=d),a[d].match(/^m=video/)&&(c=d);b&&c&&n(a,b,c);return a.join(h)},removeH264:function(a){__p&&__p();var b,c=a;a=function(){var a=c.split(h),b=/^a=rtpmap:\d+\s+H264\//,d=a.findIndex(function(a){return b.test(a)}),e=/^m=video/,f=a.findIndex(function(a){return e.test(a)});if(d==-1||f==-1)return"break";c=o(a,d,f).join(h)};do{var b=a();if(b==="break")break}while(!0);return c},removeVP9:function(a){var b=a.split(h),c=/^a=rtpmap:\d+\s+VP9\//,d=b.findIndex(function(a){return c.test(a)}),e=/^m=video/,f=b.findIndex(function(a){return e.test(a)});return d!==-1&&f!==-1?o(b,d,f).join(h):a},removeUnknownRtpHeaderExtensions:function(a){a=a.split(h);a=a.filter(function(a){return!a.match(/^a=extmap:/)||l.some(function(b){return a.includes(b)})});return a.join(h)},isVideoSupported:function(a){return!!a&&(a.indexOf("m=video")!==-1&&a.indexOf(i)===-1||p.getFBFeatures(a).includes("video"))},setDtlsRole:function(a,b){if(!a.match(/setup:(active|passive|actpass)/))return a.replace(/(a=fingerprint:.+)/g,"$1"+h+"a=setup:"+b);else return a.replace(/setup:actpass/g,"setup:"+b)},setVideoBitrateConstraint:function(a){var c=b("UserAgent").isBrowser("Firefox"),d=c?"TIAS":"AS";c=c?72e4:720;var e=new RegExp("^b="+d+":","m");if(a.match(e))return a;a=a.replace(/^a=mid:video\r\n/m,"a=mid:video"+h+"b="+d+":"+c+h);return a},removeSdparta:function(a){__p&&__p();a=a.split(h);var c="audio",d=!1,e=-1;for(var f=0;f<a.length;f++){var g=a[f];g.indexOf("m=audio")===0&&(c="audio");g.indexOf("m=video")===0&&(d=!0,c="video");g.indexOf("a=mid:sdparta_")===0&&(a[f]="a=mid:"+c);g.indexOf("a=group:BUNDLE sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio sdparta_")===0&&(e=f);g.indexOf("a=group:BUNDLE audio video sdparta_")===0&&b("FBLogger")("rtc_www").mustfix("content_name rewriting will not work anymore, fix sdparta_# in Firefox.")}e>-1&&(d?a[e]="a=group:BUNDLE audio video":a[e]="a=group:BUNDLE audio");return a.join(h)},useDTLSOverCrypto:function(a){if(!(b("UserAgent").isBrowser("Chrome >= 57")||b("UserAgent").isBrowser("Opera >= 44")))return a;return!/^a=fingerprint:/m.test(a)?a:a.split(h).filter(function(a){return a.indexOf("a=crypto:")!==0}).join(h)},validateOfferSdp:function(a,b){__p&&__p();if(a.split(":")[0]==="LIVE"){a=function(){var a=/^m=/,c=/^m=audio/,d=/^m=video/,e=/^a=ssrc:/,f=b.split(h),g=[];for(var i=f.length-1;i>=0;i--)a.test(f[i])&&g.push(f.splice(i));var j=!1,k=!1;g.forEach(function(a){c.test(a[0])&&!j?j=a.some(function(a){return e.test(a)}):d.test(a[0])&&!k&&(k=a.some(function(a){return e.test(a)}))});return{v:j&&k}}();if(typeof a==="object")return a.v}return!0},clearFirefoxInactiveDataChannelBlock:function(a){__p&&__p();if(!b("UserAgent").isBrowser("Firefox"))return a;var c=a.split(h),d=c.findIndex(function(a){return a.startsWith("m=application")});if(d===-1)return a;var e=c.slice(d),f=e.findIndex(function(a,b){return b>0&&a.startsWith("m=")});f!==-1&&(e=e.slice(0,f));if(e[0]!=null&&e[0].endsWith("0")&&e.some(function(a){return a.startsWith("a=inactive")})){f=e.findIndex(function(a){return a.startsWith("c=")});return[].concat(c.slice(0,d+1+(f!==-1?f:0)),c.slice(d+e.length)).join(h)}return a},addFBFeatures:a,getFBFeatures:c};function a(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(c.length<1)return a;var e=q(a),f=e[0],i=e[1],j=f.split(h),k=r(j),l=j.filter(function(a){return!a.startsWith(g)}),m=1+l.map(function(a){return a?a.substr(0,2):""}).lastIndexOf("a=")||l.length;return[].concat(l.slice(0),s([].concat(k,c)).map(function(a){return""+g+a}),l.slice(m),[i?[i.trim(),""].join(h):""]).join(h)}function c(a){a=q(a);a=a[0];return r(a.split(h))}function q(a){if(!a)return["",""];var b=a.trim().split(h),c=0;while(c<b.length){if(b[c].startsWith("m="))break;c++}return c===b.length?[a.trim(),""]:[b.slice(0,c).join(h).trim(),b.slice(c).join(h).trim()]}function r(a){return s(a.filter(function(a){return a.startsWith(g)}).map(function(a){return a.substr(g.length)}))}function s(a){__p&&__p();var b=Object.create(null);for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e&&(b[e]=!0)}return Object.keys(b).sort()}e.exports=p}),null);
__d("FBRTCMessage",["FBRTCConstants","FBRTCExperiment","FBRTCSdpUtils","FBRTCSupport"],(function(a,b,c,d,e,f){__p&&__p();var g="mobile";function a(a){"use strict";__p&&__p();if(!this.$1(a))throw new Error("invalid webrtc message");this.originalMessageData=a;this.peerID=a.from;this.callID=parseInt(a.call_id,10);this.msg=JSON.parse(a.payload);this.msg.json_payload&&(this.escalationName=this.msg.sessionName,this.msg=this.msg.json_payload);this.msgType=this.msg.type;this.msgID=this.msg.msg_id;this.ackID=this.msg.ack_id;this.source=a.source;this.peerSupportsVideoInterop=!!this.msg.supports_video_interop;this.$2();this.$3();this.$4();this.$5()}a.prototype.$1=function(a){"use strict";return a.from&&a.call_id&&a.payload};a.prototype.$2=function(){"use strict";if(this.peerSupportsVideoInterop)return;this.isFromMobile()&&this.disableVideo()};a.prototype.disableVideo=function(){"use strict";this.msg.sdp&&(this.msg.sdp=b("FBRTCSdpUtils").disableVideo(this.msg.sdp)),(this.msgType===b("FBRTCConstants").PayloadType.SET_VIDEO||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ANSWER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_ANSWER)&&(this.msg.videoon=!1)};a.prototype.$3=function(){"use strict";this.isFromMobile()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE&&(this.msg.sdp=b("FBRTCSdpUtils").removeFEC(this.msg.sdp))};a.prototype.$4=function(){"use strict";if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("FBRTCExperiment").gen("rtc_browser_use_h264");a=a.getParam("allow_h264","no");a!=="yes"&&(this.msg.sdp=b("FBRTCSdpUtils").removeH264(this.msg.sdp))}};a.prototype.$5=function(){"use strict";if(this.isFromMobile()&&b("FBRTCSupport").isWebrtcSupported()&&this.msg.sdp&&this.msgType!==b("FBRTCConstants").PayloadType.ICE_CANDIDATE){var a=b("FBRTCExperiment").gen("rtc_browser_use_vp9");a=a.getParam("allow_vp9","no");a!=="yes"&&(this.msg.sdp=b("FBRTCSdpUtils").removeVP9(this.msg.sdp))}};a.prototype.isOffer=function(){"use strict";return this.msgType===b("FBRTCConstants").PayloadType.OFFER};a.prototype.isFromMobile=function(){"use strict";return this.source===g};a.prototype.isRemoteVideoSupported=function(){"use strict";return!this.msg.sdp||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE?!0:b("FBRTCSdpUtils").isVideoSupported(this.msg.sdp)};a.prototype.isRetry=function(){"use strict";return!!this.msg.flag};a.prototype.isForCall=function(a,c){"use strict";return this.escalationName&&(this.msgType===b("FBRTCConstants").PayloadType.HANGUP||this.msgType===b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY)?c===this.escalationName:!a||a===this.callID||this.msgType===b("FBRTCConstants").PayloadType.OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICERESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.PCRESTART_OFFER||this.msgType===b("FBRTCConstants").PayloadType.ICE_CANDIDATE};a.prototype.getSignalingExperiments=function(){"use strict";return this.isFromMobile()&&!this.msg.experiments?["sdp_update"]:this.msg.experiments};e.exports=a}),null);
__d("FBRTCVideoEscalationStore",["FBRTCCallControlActions","FBRTCConstants","FBRTCStore","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=25e3,i=1e4,j=b("keyMirror")({direct_video:null,escalated:null,escalation_declined:null,voip:null});c=babelHelpers.inherits(a,b("FBRTCStore"));g=c&&c.prototype;function a(a,b,c){g.constructor.call(this),this.$FBRTCVideoEscalationStore7=a,this.$FBRTCVideoEscalationStore2=b,this.$FBRTCVideoEscalationStore1=c,this.$FBRTCVideoEscalationStore4=c,this.$FBRTCVideoEscalationStore3=!1,this.$FBRTCVideoEscalationStore5=null,this.$FBRTCVideoEscalationStore8=null}a.prototype.isPending=function(){return!!this.$FBRTCVideoEscalationStore5};a.prototype.callHasEscalated=function(){return this.$FBRTCVideoEscalationStore1};a.prototype.getCallType=function(){if(!this.$FBRTCVideoEscalationStore2.isRemoteVideoSupported)return j.voip;else if(this.$FBRTCVideoEscalationStore4)return j.direct_video;else if(this.$FBRTCVideoEscalationStore1)return j.escalated;else if(this.$FBRTCVideoEscalationStore3)return j.escalation_declined;return j.voip};a.prototype.__onDispatch=function(a){__p&&__p();switch(a.type){case b("FBRTCCallControlActions").Types.RECEIVED_SIGNALING_MESSAGE:var c=a.message;a.message_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&(this.$FBRTCVideoEscalationStore3=!0,c.ackID?this.$FBRTCVideoEscalationStore10(c):this.$FBRTCVideoEscalationStore11(c));a.message_type===b("FBRTCConstants").PayloadType.ACK&&c.msg.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$FBRTCVideoEscalationStore12(c);break;case b("FBRTCCallControlActions").Types.ACCEPT_ESCALATION:this.$FBRTCVideoEscalationStore13(!0);break;case b("FBRTCCallControlActions").Types.DECLINE_ESCALATION:this.$FBRTCVideoEscalationStore13(!1);break;case b("FBRTCCallControlActions").Types.TOGGLE_MUTE_VIDEO:this.$FBRTCVideoEscalationStore3=!0;this.getDispatcher().waitFor([this.$FBRTCVideoEscalationStore2.getDispatchToken()]);this.$FBRTCVideoEscalationStore14();break}};a.prototype.$FBRTCVideoEscalationStore12=function(a){this.$FBRTCVideoEscalationStore8&&this.$FBRTCVideoEscalationStore8.msg_id===a.ackID&&this.$FBRTCVideoEscalationStore15()};a.prototype.$FBRTCVideoEscalationStore15=function(){clearTimeout(this.$FBRTCVideoEscalationStore6)};a.prototype.$FBRTCVideoEscalationStore16=function(){this.$FBRTCVideoEscalationStore6=setTimeout(function(){if(!this.$FBRTCVideoEscalationStore8)return;this.$FBRTCVideoEscalationStore7.resendPayload(this.$FBRTCVideoEscalationStore2.peerID,this.$FBRTCVideoEscalationStore8)}.bind(this),i)};a.prototype.$FBRTCVideoEscalationStore10=function(a){__p&&__p();if(!this.$FBRTCVideoEscalationStore8||a.ackID!==this.$FBRTCVideoEscalationStore8.msg_id)return;clearTimeout(this.$FBRTCVideoEscalationStore9);this.$FBRTCVideoEscalationStore15();var b=a.msg,c=a.peerID;a=a.callID;var d=this.$FBRTCVideoEscalationStore17(b);this.$FBRTCVideoEscalationStore7.sendAck(c,a,b);this.$FBRTCVideoEscalationStore8=null;this.$FBRTCVideoEscalationStore1=d;this.$FBRTCVideoEscalationStore18(d);!d&&this.$FBRTCVideoEscalationStore2.localStream.hasVideo()&&this.$FBRTCVideoEscalationStore2.localStream.toggleMuteVideo();this.__emitChange()};a.prototype.$FBRTCVideoEscalationStore11=function(a){if(this.$FBRTCVideoEscalationStore1){this.$FBRTCVideoEscalationStore17(a.msg)?(this.$FBRTCVideoEscalationStore5=a,this.$FBRTCVideoEscalationStore13(!0)):this.$FBRTCVideoEscalationStore2.remoteStream.setVideoEnabled(!1);return}var c=a.msg,d=a.peerID,e=a.callID;this.$FBRTCVideoEscalationStore7.sendAck(d,e,c);this.$FBRTCVideoEscalationStore17(c)?(this.$FBRTCVideoEscalationStore5=a,this.$FBRTCVideoEscalationStore9=setTimeout(function(){b("FBRTCCallControlActions").declineEscalation()},h)):this.$FBRTCVideoEscalationStore5=null;this.__emitChange()};a.prototype.$FBRTCVideoEscalationStore13=function(a){__p&&__p();clearTimeout(this.$FBRTCVideoEscalationStore9);if(this.$FBRTCVideoEscalationStore5){var b=this.$FBRTCVideoEscalationStore5,c=b.peerID,d=b.callID;b=b.msgID;this.$FBRTCVideoEscalationStore8=this.$FBRTCVideoEscalationStore7.sendVideoRequestResponse(c,d,b,a);this.$FBRTCVideoEscalationStore16();this.$FBRTCVideoEscalationStore1=a;this.$FBRTCVideoEscalationStore5=null;this.__emitChange()}};a.prototype.$FBRTCVideoEscalationStore14=function(){if(this.$FBRTCVideoEscalationStore1){this.$FBRTCVideoEscalationStore19();return}this.$FBRTCVideoEscalationStore8=this.$FBRTCVideoEscalationStore7.sendVideoEscalationRequest(this.$FBRTCVideoEscalationStore2.peerID,this.$FBRTCVideoEscalationStore2.callID,this.$FBRTCVideoEscalationStore2.localStream.hasVideo());this.$FBRTCVideoEscalationStore2.localStream.hasVideo()?(this.$FBRTCVideoEscalationStore16(),this.$FBRTCVideoEscalationStore9=setTimeout(function(){this.$FBRTCVideoEscalationStore2.localStream.hasVideo()&&b("FBRTCCallControlActions").toggleMuteVideo()}.bind(this),h)):(this.$FBRTCVideoEscalationStore15(),clearTimeout(this.$FBRTCVideoEscalationStore9),this.$FBRTCVideoEscalationStore8=null);this.__emitChange()};a.prototype.$FBRTCVideoEscalationStore19=function(){if(!this.$FBRTCVideoEscalationStore2.isRemoteVideoSupported)return;this.$FBRTCVideoEscalationStore7.sendMuteStateUpdate(this.$FBRTCVideoEscalationStore2.peerID,this.$FBRTCVideoEscalationStore2.callID,this.$FBRTCVideoEscalationStore2.localStream.hasVideo())};a.prototype.$FBRTCVideoEscalationStore18=function(a){this.$FBRTCVideoEscalationStore2.remoteStream.setVideoEnabled(a)};a.prototype.$FBRTCVideoEscalationStore17=function(a){return!!(a.reqVideoOn||a.videoon)};a.CallType=j;e.exports=a}),null);
__d("RTCP2PCallEscalationStoreState",["FBRTCMessage","FBRTCVideoEscalationStore","immutable"],(function(a,b,c,d,e,f){var g;c=b("FBRTCVideoEscalationStore").CallType;g=babelHelpers.inherits(a,b("immutable").Record({awaitingACK:!1,callType:c.voip,escalated:!1,failureReason:null,initiatedEscalation:!1,inProgress:!1,request:null,response:null,token:null}));g&&g.prototype;function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerRTCFunnelLogger",["FunnelLogger","FBRTCConstants","RTCCallActionTypes","FBRTCCallControlActions","RTCP2PCallActionTypes","RTCP2PCallEscalationActionTypes","RTCP2PCallEscalationStoreState","URI","UserAgentData"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").SignalingProtocol,h=b("FBRTCCallControlActions").Types,i="WEB_MESSENGER_RTC_FUNNEL",j=i+"_append",k=i+"_tags",l=i+"_end",m=null;function a(a){b("FunnelLogger").startFunnel(i),o([a]),n()}function n(){var a={bn:b("UserAgentData").browserName,bv:b("UserAgentData").browserVersion,os:b("UserAgentData").platformName,dn:b("URI").getRequestURI().getDomain().split(".").slice(-2).join(".")};Object.keys(a).forEach(function(c){b("FunnelLogger").addFunnelTag(i,c+":"+(a[c]||"unknown"))})}function o(a){if(window.opener&&window.opener.postMessage&&m){window.opener.postMessage({type:k,nonce:m,tags:a},window.location.origin);return}a.forEach(function(a){b("FunnelLogger").addFunnelTag(i,a)})}function p(a,c){if(window.opener&&window.opener.postMessage&&m){window.opener.postMessage({type:i+"_append",nonce:m,action:a,actionTag:c},window.location.origin);return}c===undefined?b("FunnelLogger").appendActionIfNew(i,a):b("FunnelLogger").appendActionWithTag(i,a,c)}function q(a){if(window.opener&&window.opener.postMessage&&m){window.opener.postMessage({type:i+"_end",nonce:m,action:a},window.location.origin);return}a&&p(a);b("FunnelLogger").endFunnel(i)}function c(a){m=a}function d(a){var b=function b(event){if(event.origin!==window.location.origin||!event.data||event.data.nonce!==a)return;event.data.type===j?p(event.data.action,event.data.actionTag):event.data.type===k?o(event.data.tags):event.data.type===l&&(q(event.data.action),window.removeEventListener("message",b))};window.addEventListener("message",b)}function f(a,b){switch(a){case h.RECEIVED_SIGNALING_MESSAGE:break;case"END_CALL":p(a,b);q();break;default:p(a,b)}}function r(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ON_CONFERENCE_STATE:case b("RTCCallActionTypes").SET_CALL_SUMMARY:case b("RTCCallActionTypes").SET_DOMINANT_SPEAKER:case b("RTCCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS:case b("RTCCallActionTypes").SET_GRID_VIEW:case b("RTCCallActionTypes").SET_STRIP_VIEW:case b("RTCP2PCallActionTypes").SET_REMOTE_SIGNALING_EXPERIMENTS:case b("RTCP2PCallActionTypes").SET_CALL_TYPE:case b("RTCP2PCallActionTypes").P2P_INIT_NUX_STATE:break;case b("RTCP2PCallActionTypes").P2P_PROCESS_MESSAGE:var d=[];c.message&&!c.message.isRemoteVideoSupported()&&d.push("remove_video_unsupported");c.message&&c.message.isFromMobile()?d.push("peer_on_mobile"):d.push("peer_on_web");o(d);break;case b("RTCP2PCallActionTypes").SET_CONNECTION_STATUS:p(c.connectionStatus);break;case b("RTCCallActionTypes").SET_END_CALL_REASON:p(c.type,c.endCallReason&&c.endCallReason.toStrName(!0));setTimeout(q,1e3);break;case b("RTCCallActionTypes").INIT:c.protocol===g.P2P&&o(["p2p","v2"]);break;case b("RTCCallActionTypes").SET_LAYOUT:p(c.type,c.layout);break;case b("RTCCallActionTypes").SET_MW_CALL_TYPE:p(c.type,c.callType);break;case b("RTCCallActionTypes").END_CALL:p(c.type,c.endCallReason);break;default:p(c.type)}return a}function s(a,c){switch(c.type){case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_START:case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SUCCESS:case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE:p(c.type,"caller");break;case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_REQUEST:case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_RESPONSE:case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_ACK:p(c.type,"callee");break;default:return a}return a}a={appendAction:p,addFunnelTags:o,endFunnel:q,startFunnel:a,setWindowNonce:c,listenCrossWindowAction:d,logRTCCallAction:r,logRTCP2PV1Action:f,logRTCCallEscalationAction:s};e.exports=a}),null);
__d("FBRTCAvailability",["ChannelConstants","PresenceStatus"],(function(a,b,c,d,e,f){"use strict";a={isCallable:function(a){a=b("PresenceStatus").getCapabilities(a);var c=b("ChannelConstants").CAPABILITY_VOIP_INTEROP;return!!(a&c)}};e.exports=a}),null);
__d("FBRTCCallUIWrapper",["regeneratorRuntime","Bootloader","MessengerRTCFunnelLogger","UserAgent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=null;a={openGroupCallUI:function(a,c,d,e,f,h){return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=this._openWindow("Group Call"),b("Bootloader").loadModules(["FBRTCCallUI"],function(b){b.openGroupCallUI(a,c,d,e,f,g,h)},"FBRTCCallUIWrapper");case 2:case"end":return i.stop()}},null,this)},openGroupCallURI:function(a,c,d,e,f,h){return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=this._openWindow("Group Call"),b("Bootloader").loadModules(["FBRTCCallUI"],function(b){b.openGroupCallURI({conferenceName:a,callID:c,hasVideo:d,serverInfoData:e,trigger:f,callSummary:h,callWindow:g})},"FBRTCCallUIWrapper");case 2:case"end":return i.stop()}},null,this)},openAsCaller:function(a,c,d,e){!g&&window.rtcCallChildWindow&&(g=window.rtcCallChildWindow,window.rtcCallChildWindow=null);if(this._shouldFocusCallWindow(a)){g&&g.focus();return}this._shouldCloseCallWindow()&&(g&&g.close());g=this._openWindow("Video Call");b("Bootloader").loadModules(["FBRTCCallUI"],function(b){b.openAsCaller(a,c,d,e,g)},"FBRTCCallUIWrapper")},openAsCallee:function(a,c,d,e,f){g=this._openWindow("Video Call"),b("Bootloader").loadModules(["FBRTCCallUI"],function(b){b.openAsCallee(a,c,d,e,f,g)},"FBRTCCallUIWrapper")},_shouldFocusCallWindow:function(a){return!!g&&!g.closed&&g.rtcCallInProgessWith===a},_shouldCloseCallWindow:function(){return!!g&&!g.closed&&!g.rtcCallInProgessWith},_openWindow:function(a){var c=this._windowPosition();c=["menubar=no","location=no","scrollbars=no","status=no","personalbar=no",c.height,c.width,c.top,c.left].join(",");this._isSparkBrowser()&&(c="");a=window.open("",a,c);window.callWindow=a;a?b("MessengerRTCFunnelLogger").appendAction("popup_window"):b("MessengerRTCFunnelLogger").endFunnel("popup_blocked");return a},_windowPosition:function(){__p&&__p();var a=960,b=540,c=void 0,d;void 0;var e;void 0;var f=void 0;screen&&screen.width>1280&&(a=1280,b=720);window.innerWidth!==undefined?(d=window.innerWidth,c=window.innerHeight):(d=screen.width,c=screen.height);window.screenLeft!==undefined?(e=window.screenLeft,f=window.screenTop):(e=window.screenX,f=window.screenY);d=Math.floor(d/2-a/2+e);e=Math.floor(c/2-b/2+f);return{height:"height="+b.toString(),width:"width="+a.toString(),top:"top="+e.toString(),left:"left="+d.toString()}},_isSparkBrowser:function(){return b("UserAgent").isBrowser("Chrome < 34")&&b("UserAgent").isBrowser("Chrome > 33")}};e.exports=a}),null);
__d("FBRTCScreenSharingLogger",["Log","MarauderLogger","formatDate","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="webrtc_screen_sharing",h=b("keyMirror")({screen_sharing_action:null,screen_sharing_error:null}),i=b("keyMirror")({PEER_ID:null,SESSION_ID:null,CONTEXT_TYPE:null,CONTENT:null});a=b("keyMirror")({SCREEN_SHARING_TOGGLED:null,SCREEN_SHARING_CANCELLED:null,SCREEN_SHARING_ENABLED:null,SCREEN_SHARING_DISABLED:null,SCREEN_SHARING_EXT_DIALOG:null,SCREEN_SHARING_EXT_LINK:null,SCREEN_SHARING_DIALOG_SUCCESS:null,SCREEN_SHARING_DIALOG_CANCEL:null});var j=null;k.getInstance=function(){j||(j=new k());return j};k.prototype.logAction=function(a,b,c,d){var e={};e[h.screen_sharing_action]=c;e[i.PEER_ID]=a;e[i.SESSION_ID]=b;e[i.CONTEXT_TYPE]=this.$1();e[i.CONTENT]=d;this.$2(h.screen_sharing_action,e);this.logToConsole(a,b,c)};k.prototype.logError=function(a,b,c){var d={};d[i.PEER_ID]=a;d[i.SESSION_ID]=b;d[i.CONTEXT_TYPE]=this.$1();d[i.CONTENT]=c;this.$2(h.screen_sharing_error,d);this.logToConsole(a,b,c)};k.prototype.logToConsole=function(a,b,c){};k.prototype.$1=function(){return"p2p_video_call"};k.prototype.$2=function(a,c){b("MarauderLogger").log(a,g,c)};function k(){}k.Action=a;e.exports=k}),null);
__d("FBRTCVersionDetection",["UserAgent","UserAgentData"],(function(a,b,c,d,e,f){__p&&__p();a={isChrome:function(){return b("UserAgent").isBrowser("Chrome")},isFirefox:function(){return b("UserAgent").isBrowser("Firefox")},isChromium:function(){return!!navigator.webkitGetUserMedia},webrtcVersion:function(){if(this.isFirefox()||this.isChrome())return b("UserAgentData").browserVersion;if(this.isChromium()){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a!=null?parseInt(a[2],10):999}return 0}};e.exports=a}),null);
__d("FBRTCScreenSharingUtils",["Promise","FBRTCScreenSharingLogger","FBRTCStruct","FBRTCVersionDetection","RTCConfig","FBRTCExperiment","FBRTCSupport"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("FBRTCStruct"))(["UNKNOWN","INSTALLED"]),h=g.UNKNOWN,i={RECIPIENT:"SC_CONTENT_SCRIPT",isScreenSharingSupportedV1:function(){return b("RTCConfig").ScreenSharingGK},isScreenSharingSupported:function(){if(b("RTCConfig").ScreenSharingGK)return!0;var a=b("FBRTCExperiment").gen("webrtc_enable_screen_sharing");return a.getBool("can_screen_sharing",!1)},isGroupCallScreenSharingSupported:function(){return b("RTCConfig").ScreenSharingToGroupGK},isSupportedBrowser:function(){return b("FBRTCVersionDetection").isChrome()&&b("FBRTCVersionDetection").webrtcVersion()>=34},canUserReceiveScreenSharing:function(){return b("FBRTCSupport").isOSSupported()&&b("FBRTCVersionDetection").isChromium()&&b("FBRTCVersionDetection").webrtcVersion()>=34},canPeerReceiveScreenSharing:function(a){if(a.remoteSupport("screen_sharing"))return!0;if(!a.remoteSupport("www")&&!a.remoteSupport("mweb")){if(b("RTCConfig").ScreenSharingToMobileGK)return!0;a=b("FBRTCExperiment").gen("webrtc_enable_screen_sharing");return a.getBool("can_share_to_mobile",!1)}return!1},isExtensionInstalled:function(){return h===g.INSTALLED},getExtensionStatus:function(){return h},checkExtensionInstalled:function(){__p&&__p();if(this.isExtensionInstalled())return b("Promise").resolve();var a=void 0,c=new(b("Promise"))(function(b){a=function(c){var d=c.origin;c=c.data;if(d!=window.location.origin||!c.type)return;c.type==="SC_EXT_INSTALLED"&&(window.removeEventListener("message",a),h=g.INSTALLED,b())},window.addEventListener("message",a)});return b("Promise").race([c,this._pokeExtension()])["catch"](function(c){window.removeEventListener("message",a);return b("Promise").reject(c)})},_pokeExtension:function(){var a=arguments.length<=0||arguments[0]===undefined?13:arguments[0];return new(b("Promise"))(function(b,c){var d=setInterval(function(){setTimeout(function(){h===g.UNKNOWN&&window.postMessage({recipient:i.RECIPIENT,type:"SC_IS_EXT_INSTALLED",text:"is extension installed"},"*")}),a>0?a--:(clearInterval(d),c("extension unavailable"))},200)})},logFailedAttempt:function(a,c){b("FBRTCScreenSharingLogger").getInstance().logAction(a,c,b("FBRTCScreenSharingLogger").Action.SCREEN_SHARING_TOGGLED,"feature not available")}};e.exports=i}),null);
__d("RTCSignalingExperiments",["FBRTCScreenSharingUtils","FBRTCSupport","FBRTCVersionDetection","UserAgent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){this.$2=new Set(),this.$1=new Set(g.getLocal()),a&&(this.$2=new Set(a))}g.prototype.getLocal=function(){return Array.from(this.$1)};g.prototype.setRemote=function(a){return!a?this:new g(a)};g.prototype.getRemote=function(){return Array.from(this.$2)};g.prototype.support=function(a){return this.localSupport(a)&&this.remoteSupport(a)};g.prototype.localSupport=function(a){return this.$1.has(a)};g.prototype.remoteSupport=function(a){return this.$2.has(a)};g.getLocal=function(){var a=[];(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera")||b("UserAgent").isBrowser("Firefox >= 38"))&&a.push("sdp_update");h()&&a.push("multiple_streams_plan_b");b("FBRTCScreenSharingUtils").canUserReceiveScreenSharing()&&a.push("screen_sharing");b("FBRTCSupport").isOSSupported()?a.push("www"):a.push("mweb");return a};function h(){return(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera"))&&b("FBRTCVersionDetection").webrtcVersion()>=34}e.exports=g}),null);
__d("FBRTCConfig",["CurrentUser","RTCSignalingExperiments"],(function(a,b,c,d,e,f){__p&&__p();var g=!1,h=!1,i=0,j={};a={setConfig:function(a,b,c,d,e){j=a,i=b,g=d,h=e},isVCEndpointCall:function(){return g},canPeerUseV2:function(){return h},getPeerID:function(){return i},statsInterpreterConfig:function(){return{rtt_weight:2,frr_weight:800,plr_weight:500,score_threshold:1e3,bad_score_count:3}},settingsEnabled:function(){return j.enable_settings},shouldAutoDisableVideo:function(){return!1},unsupportedBrowserUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.unsupported_browser)return j.troubleshooting_urls.unsupported_browser;if(b("CurrentUser").isWorkUser())return"https://www.facebook.com/help/work/919532078125908";else return"https://www.facebook.com/help/211644178877843"},userMediaErrorUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.user_media_error)return j.troubleshooting_urls.user_media_error;if(b("CurrentUser").isWorkUser())return"https://www.facebook.com/help/work/180714775754632";else return"https://www.facebook.com/help/232232800134371"},userMediaPermissionErrorUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.user_media_permission_error)return j.troubleshooting_urls.user_media_permission_error;if(b("CurrentUser").isWorkUser())return"https://www.facebook.com/help/work/180714775754632";else return"https://www.facebook.com/help/232232800134371"},supportedSignalingExperiments:function(){return b("RTCSignalingExperiments").getLocal()},isMessengerDotCom:function(){return j.is_messenger_dot_com},useMessengerCallUI:function(){return j.messenger_call_ui},shouldCreateDataChannel:function(){return j.data_channel},disableURLManager:function(){return j.disable_url_manager}};e.exports=a}),null);
__d("FBRTCConsoleLogger",["Log","LogHistory","formatDate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="webrtc",h=null;i.getInstance=function(){h||(h=new i());return h};function i(){this.$1=b("LogHistory").getInstance(g)}i.prototype.getLogHistory=function(){return this.$1};i.prototype.log=function(a,b,c){var event=arguments.length<=3||arguments[3]===undefined?"Console":arguments[3];this.$1.log(event||"Console",a);return this};i.MODULE_NAME=g;e.exports=i}),null);
__d("FBRTCUtils",["AsyncRequest","CollabCallTriggerType","CurrentUser","FBIDCheck","FBRTCConfig","FBRTCConstants","RTCConfig","emptyFunction","randomInt"],(function(a,b,c,d,e,f){__p&&__p();var g=6e3,h=window.URL||window.webkitURL,i="setSinkId"in window.HTMLMediaElement.prototype,j="srcObject"in window.HTMLMediaElement.prototype,k="mozSrcObject"in window.HTMLMediaElement.prototype;a={attachMediaStream:function(a,b){__p&&__p();if(a==null)return;if(j){a.srcObject=b;b&&a.play();return}if(k){a.mozSrcObject=b;b&&a.play();return}a.src&&h.revokeObjectURL(a.src);a.src=b?h.createObjectURL(b):""},reattachMediaStream:function(a,b){__p&&__p();if(j){a.srcObject=b.srcObject;a.play();return}if(k){a.mozSrcObject=b.mozSrcObject;a.play();return}a.src=b.src},generateRandomInt:function(){return b("randomInt")(0,4294967294)+1},aboutEqual:function(a,b){return a-b<.01&&b-a<.01},getUploadLogLevel:function(a){return Math.max(this.getLocalUploadLogLevel(),a)},getLocalUploadLogLevel:function(){return b("CurrentUser").isEmployee()?b("FBRTCConstants").UploadLogLevel.LL_DEBUG:b("FBRTCConstants").UploadLogLevel.LL_NONE},sendServerRequest:function(a){var c=arguments.length<=1||arguments[1]===undefined?b("emptyFunction"):arguments[1],d=arguments.length<=2||arguments[2]===undefined?b("emptyFunction"):arguments[2],e=arguments.length<=3||arguments[3]===undefined?!1:arguments[3],f=arguments.length<=4||arguments[4]===undefined?g:arguments[4],h=arguments.length<=5||arguments[5]===undefined?{}:arguments[5],i=new(b("AsyncRequest"))().setURI(a).setData(h).setAllowCrossPageTransition(!0).setHandler(c).setErrorHandler(d).setTimeoutHandler(f,function(){d()});e&&i.setOption("asynchronous_DEPRECATED",!1);i.send()},supportsSetSink:function(){return i},isPeerVCEndpoint:function(a){var c=b("FBRTCConfig").isVCEndpointCall();return c!==undefined?c:!!a&&!b("FBIDCheck").isUser_deprecated(a)&&b("RTCConfig").CollabVCEndpointsVideoCallGK},isCollabTrigger:function(a){return a===b("CollabCallTriggerType").QUICK_DIAL||a===b("CollabCallTriggerType").MEETING_ROOM_PAGE_PROFILE}};e.exports=a}),null);
__d("FBRTCCore",["invariant","Bootloader","FBRTCAvailability","FBRTCCallUIWrapper","FBRTCSupport","FBRTCUtils","MessengerRTCFunnelLogger"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=!1;a={startOutgoingCall:function(a,c,d){__p&&__p();var e=arguments.length<=3||arguments[3]===undefined?!1:arguments[3];/\D/.test(a)&&g(0);if(h)return;b("MessengerRTCFunnelLogger").addFunnelTags([d?"audio_only":"video","p2p"]);h=!0;setTimeout(function(){h=!1},1e3);if(e&&!b("FBRTCSupport").isCollabSupported())b("Bootloader").loadModules(["FBRTCUnsupportedBrowserMessage","CollabMessengerLogger"],function(c,d){c.showForUnsupportedCollabCall(),d.logBrowserNotSupported({peerID:a}),b("MessengerRTCFunnelLogger").endFunnel("unsupported_browser")},"FBRTCCore");else if(!b("FBRTCSupport").isWebrtcSupported())b("Bootloader").loadModules(["FBRTCUnsupportedBrowserMessage"],function(a){a.showForOutgoingCall(),b("MessengerRTCFunnelLogger").endFunnel("unsupported_browser")},"FBRTCCore");else{var f=b("FBRTCUtils").generateRandomInt();b("FBRTCCallUIWrapper").openAsCaller(a,f,c,d)}},startGroupCall:function(a){__p&&__p();var c=a.conferenceName,d=a.hasVideo,e=a.serverInfoData,f=a.trigger;a=a.usersToRing;a=a===undefined?[]:a;if(h)return;b("MessengerRTCFunnelLogger").addFunnelTags([d?"video":"audio_only","group"]);h=!0;setTimeout(function(){h=!1},1e3);if(!b("FBRTCSupport").isGroupCallWebtrcSupported()){b("Bootloader").loadModules(["MessengerRTCUnsupportedBrowserDialogController"],function(a){a.render({hasVideo:d,isGroupCall:!0}),b("MessengerRTCFunnelLogger").endFunnel("unsupported_browser")},"FBRTCCore");return}b("FBRTCCallUIWrapper").openGroupCallUI(c,b("FBRTCUtils").generateRandomInt(),a,d,f,e)},isAvailableForWebrtcCalling:function(a){return b("FBRTCAvailability").isCallable(a)},shouldEnableVideoCalling:function(){return b("FBRTCSupport").isOSSupported()}};e.exports=a}),null);
__d("FBRTCLogger",["ChannelManager","FBRTCConsoleLogger","MarauderLogger","RTCConfig","VideoCallTypedLogger","pageID"],(function(a,b,c,d,e,f){__p&&__p();var g="sent_message",h="received_message",i="send_succeeded",j="send_failed",k="info",l="call_action",m="client_event",n="client_error",o="type",p="msg_id",q="ack_msg_id",r="call_id",s="from",t="to",u="content",v="tag",w="peer_id",x="error_code",y="trigger",z="endcallstats",A="channel_session_id",B=null;C.getInstance=function(){"use strict";B||(B=new C());return B};C.prototype.logToConsole=function(a){"use strict";this.$1(null,null,"Console",a)};C.prototype.logReceivedMessage=function(a,c,d){"use strict";__p&&__p();var e={};e[s]=a;e[r]=c;e[o]=d.type;e[p]=d.msg_id;d.sdp&&(e[u]=d.sdp);d.ack_id&&(e[q]=d.ack_id);if(b("RTCConfig").rtc_message_logging){var f=d.type||d.msgType;new(b("VideoCallTypedLogger"))().setIsClient(!0).setEvent("p2p_message_receive").setMessageType(f).setPeerID(a).setCallID(c?c.toString():null).log()}this.$2(h,e);this.$1(a,c,"Received",d.type+", "+d.msg_id)};C.prototype.logSentMessage=function(a,b,c){"use strict";__p&&__p();var d={};d[t]=a;d[r]=b;d[o]=c.type;d[p]=c.msg_id;c.sdp&&(d[u]=c.sdp);c.ack_id&&(d[q]=c.ack_id);this.$2(g,d);this.$1(a,b,"Sent",c.type+", "+c.msg_id)};C.prototype.logSentMessageSuccess=function(a,b,c,d){"use strict";var e={};e[w]=a;e[r]=b;e[o]=c;e[p]=d;this.$2(i,e)};C.prototype.logSentMessageFailure=function(a,b,c,d,e){"use strict";var f={};f[w]=a;f[r]=b;f[o]=c;f[p]=d;f[x]=e;this.$2(j,f);this.$1(a,b,"Send Failed",c+", "+e)};C.prototype.logCallAction=function(a,b,c,d,e){"use strict";var f={};f[w]=a;f[r]=b;f[l]=c;f[u]=d;e&&(f[y]=e);this.$2(l,f);this.$1(a,b,"CallAction",c+", "+JSON.stringify(d))};C.prototype.logEvent=function(a,b,event){"use strict";var c={};c[w]=a;c[r]=b;c[u]=event;this.$2(m,c);this.$1(a,b,"Event",JSON.stringify(event))};C.prototype.logInfo=function(a,b,c){"use strict";var d={};d[w]=a;d[r]=b;d[u]=c;this.$2(k,d);this.$1(a,b,"Info",JSON.stringify(c))};C.prototype.logError=function(a,b,c){"use strict";var d={};d[w]=a;d[r]=b;d[u]=c;this.$2(n,d);this.$1(a,b,"Error",JSON.stringify(c))};C.prototype.logErrorWithoutID=function(a){"use strict";this.logError(null,null,a)};C.prototype.logEndCallSummary=function(a){"use strict";__p&&__p();if(!a)return;var c={};c[w]=a.peerID;c[r]=a.callID;c[v]=z;c[u]=a.toString();c[A]=b("ChannelManager").getCompleteConfig().sessionID;var d=a.getExtraInfo();for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(c[e]=d[e]);this.$2(k,c);this.$1(a.peerID,a.callID,"Call Summary",JSON.stringify(c))};C.prototype.$2=function(a,c){"use strict";c.page_id=b("pageID"),b("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,c),b("MarauderLogger").log(a,b("FBRTCConsoleLogger").MODULE_NAME,c)};C.prototype.$1=function(a,c,d,e){"use strict";b("FBRTCConsoleLogger").getInstance().log(e,a,c,d)};function C(){"use strict"}C.CallAction={START_CALL:"start_call",RECEIVED_CALL:"received_call",ANSWER_CALL:"answer_call",END_CALL:"end_call",DENIED_PERMISSION:"denied_permission",SET_MUTE:"set_mute",SET_VIDEO_ON:"set_video_on",SET_SELF_VIEW_ON:"set_self_view_on",SET_FULLSCREEN_ON:"set_fullscreen_on",START_SKYPE:"start_skype",TRY_NEW:"try_new",OPEN_POPUP:"open_popup",POPUP_OPENED:"popup_opened",AUTO_DISABLE_VIDEO:"auto_disable_video",FAILED_GETTING_URI:"failed_getting_uri",OLD_URI:"old_uri",USER_SETTINGS_CHANGED:"user_settings_changed"};C.Trigger={ADMIN_MESSAGE:"admin_message",CHAT_TAB_ICON:"chat_tab_icon",CHAT_TAB_ICON_TOUR:"chat_tab_icon_tour",CHAT_TAB_VOICE_ICON:"chat_tab_voice_icon",SKYPE_DEPRECATION_DIALOG:"skype_deprecation_dialog",REDIAL_BUTTON:"redial_button",RETURN_CALL:"return_call",WEB_MESSENGER:"web_messenger",POPUP_CALL_START_BUTTON:"popup_start_call_button",TIMELINE_PROFILE:"timeline_profile",UNKNOWN:"unknown",RESET_CALL:"install_screen_sharing_ext_dialog",MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:"multiway_chat_tab_sheet_join_call_button",MULTIWAY_POPUP_START_CALL_BUTTON:"multiway_popup_start_call_button",MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:"multiway_thread_header_audio_button",MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:"multiway_thread_header_video_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_audio_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_audio_call_video_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_video_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_video_call_video_button",MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:"multiway_thread_list_join_call_button"};C.Key={DEVICE_INFO:"device_info",RATING:"rating5",RATING_SHOWN:"rating_shown",SURVEY_CHOICE:"survey_choice",SURVEY_DETAILS:"survey_details",SURVEY_SHOWN:"survey_shown",INITIATED_BY_PAGE_ID:"initiated_by_page_id",PEER_IS_MOBILE:"peer_is_mobile",SCREEN_DURATION:"screen_duration"};e.exports=C}),null);
__d("FBRTCCallabilityActions",["keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({CALLABILITY_FETCHED:null,CALLABILITY_FETCH_ERROR:null});function a(a){this.$1=a}a.prototype.callabilityFetched=function(a,b){this.$1.dispatch({type:g.CALLABILITY_FETCHED,userID:a,callability:b})};a.prototype.callabilityFetchError=function(a){this.$1.dispatch({type:g.CALLABILITY_FETCH_ERROR,userID:a})};a.Types=g;e.exports=a}),null);
__d("XRTCCallabilityController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/rtc/callability/",{user_id:{type:"FBID",required:!0}})}),null);
__d("FBRTCCallabilityDataManager",["AsyncRequest","FBRTCCallabilityActions","TimeSlice","XRTCCallabilityController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=new(b("FBRTCCallabilityActions"))(a)}a.prototype.fetchCallability=function(a){b("TimeSlice").guard(function(){var c=b("XRTCCallabilityController").getURIBuilder().setFBID("user_id",a).getURI(),d=this.$2.bind(this,a),e=this.$3.bind(this,a);new(b("AsyncRequest"))().setURI(c).setHandler(d).setErrorHandler(e).setAllowCrossPageTransition(!0).send()}.bind(this),"Chat Tab RTC Callability Check",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.$2=function(a,b){this.$1.callabilityFetched(a,b.payload)};a.prototype.$3=function(a,b){this.$1.callabilityFetchError(a)};e.exports=a}),null);
__d("RTCCallabilityStore",["fbt","Cache","FBRTCCallabilityActions","FBRTCCallabilityDataManager","FluxStore","MercuryThreadInfo"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=.5,j=5;c=babelHelpers.inherits(a,b("FluxStore"));h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$RTCCallabilityStore2=new(b("FBRTCCallabilityDataManager"))(a),this.$RTCCallabilityStore1=new(b("Cache"))()}a.prototype.__onDispatch=function(a){__p&&__p();var c=a.type;switch(c){case b("FBRTCCallabilityActions").Types.CALLABILITY_FETCHED:c=a.userID;var d=a.callability;this.$RTCCallabilityStore1.set(c,{callable:d.is_callable,isBlocked:d.is_blocked},null,d.is_callable?j:i);this.__emitChange();break;case b("FBRTCCallabilityActions").Types.CALLABILITY_FETCH_ERROR:this.$RTCCallabilityStore1.set(a.userID,{callable:!1,isBlocked:!1},null,i);this.__emitChange();break}};a.prototype.isCallable=function(a,b){b=b?b.message_count>0&&b.folder==="inbox":!1;a=this.fetchUserFromCache(a);return a&&a.callable||b};a.prototype.isBlocked=function(a,c){c=c?b("MercuryThreadInfo").canReply(c):!0;a=this.fetchUserFromCache(a);return a&&a.isBlocked||!c};a.prototype.fetchUserFromCache=function(a){this.$RTCCallabilityStore1.has(a)||(this.$RTCCallabilityStore2.fetchCallability(a),this.$RTCCallabilityStore1.set(a,{callable:!1,isBlocked:!1},null,i));return this.$RTCCallabilityStore1.get(a)};a.prototype.callButtonTooltip=function(a,b){var c=arguments.length<=2||arguments[2]===undefined?!0:arguments[2],d=arguments[3];return!this.isBlocked(a,d)&&(c||this.isCallable(a))?g._("Start a video chat with {shortname}",[g._param("shortname",b)]):g._("{shortname} is currently unavailable for video calling",[g._param("shortname",b)])};a.prototype.voiceCallButtonTooltip=function(a,b){var c=arguments.length<=2||arguments[2]===undefined?!0:arguments[2],d=arguments[3];return!this.isBlocked(a,d)&&(c||this.isCallable(a))?g._("Start a voice call with {shortname}",[g._param("shortname",b)]):g._("{shortname} is currently unavailable for voice calling",[g._param("shortname",b)])};a.__moduleID=e.id;e.exports=a}),null);
__d("FBRTCCallabilityStore",["FBRTCDispatcher","RTCCallabilityStore"],(function(a,b,c,d,e,f){"use strict";e.exports=new(b("RTCCallabilityStore"))(b("FBRTCDispatcher"))}),null);
__d("RTCCallState",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NO_ONGOING_CALL:"NO_ONGOING_CALL",AUDIO_GROUP_CALL:"AUDIO_GROUP_CALL",VIDEO_GROUP_CALL:"VIDEO_GROUP_CALL"})}),null);
__d("WorkForeignEntityType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FOREIGN:"FOREIGN",NOT_FOREIGN:"NOT_FOREIGN"})}),null);